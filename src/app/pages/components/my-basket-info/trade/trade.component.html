<!-- <div fxLayout="column">
    <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px"
        class="breadcrumb with-bg with-border pt-10 pb-10 pl-20 pr-20">
        <a routerLink="/" fxLayout="column" fxLayoutAlign="center center">
            <img src="/assets/images/home-icon.svg" />
        </a>
        <span>/</span>
        <a routerLink="/baskets" class="bold">Baskets</a>
        <span>/</span>
        <a class="bold">{{basket.name}} / Trade</a>
    </div>
    <div class="main_wrapper trade_module bg-body text-dark">
        <h1 class="mat-h1 font-700 pt-10 pl-20 pr-20">Account Basket Summary</h1>
        <div class="primary-sub-section trade-prime-section">
            <div fxLayout="row wrap" fxLayoutAlign="start center" class="form-row">
                <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row"
                    fxLayoutAlign="start start" fxLayoutGap="10px" class="form-group pt-5 pb-5">
                    <span fxFlex="initial" class="trade-icon-round">
                        <mat-icon class="icon_symbol text-primary" fontIcon="shopping_basket"></mat-icon>
                    </span>
                    <div fxLayout="column">
                        <p class="no-margin">Basket</p>
                        <h3 class="mat-h3 no-margin font-600">{{basket.name}}</h3>
                    </div>
                </div>
                <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row"
                    fxLayoutAlign="start start" fxLayoutGap="10px" class="form-group pt-5 pb-5">
                    <span fxFlex="initial" class="trade-icon-round">
                        <mat-icon class="icon_symbol text-primary" fontIcon="account_balance_wallet"></mat-icon>
                    </span>
                    <div fxLayout="column">
                        <p class="no-margin">Buying Power</p>
                        <h3 class="mat-h3 no-margin font-600">{{account_balance | currency:'USD':'symbol':'1.2-2' }}
                        </h3>
                    </div>
                </div>
                <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row"
                    fxLayoutAlign="start start" fxLayoutGap="10px" class="form-group pt-5 pb-5">
                    <span fxFlex="initial" class="trade-icon-round">
                        <mat-icon class="icon_symbol text-primary" fontIcon="payments"></mat-icon>
                    </span>
                    <div fxLayout="column">
                        <p class="no-margin">Cash Balance</p>
                        <h3 class="mat-h3 no-margin font-600">{{cash_balance | currency:'USD':'symbol':'1.2-2' }}</h3>
                    </div>
                </div>
                <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row"
                    fxLayoutAlign="start start" fxLayoutGap="10px" class="form-group pt-5 pb-5">
                    <span fxFlex="initial" class="trade-icon-round">
                        <mat-icon class="icon_symbol text-primary" fontIcon="currency_exchange"></mat-icon>
                    </span>
                    <div fxLayout="column">
                        <p class="no-margin">Invested</p>
                        <h3 class="mat-h3 no-margin font-600">{{invested | currency:'USD':'symbol':'1.2-2' }}</h3>
                    </div>
                </div>
                <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row"
                    fxLayoutAlign="start start" fxLayoutGap="10px" class="form-group pt-5 pb-5">
                    <span fxFlex="initial" class="trade-icon-round">
                        <mat-icon class="icon_symbol text-primary" fontIcon="query_stats"></mat-icon>
                    </span>
                    <div fxLayout="column">
                        <p class="no-margin">Market Value</p>
                        <h3 class="mat-h3 no-margin font-600">{{market_value | currency:'USD':'symbol':'1.2-2' }}</h3>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="linkedAccount && linkedAccount.broker_account_id && brokerageIsDisconnected">
            <div class="pl-20 pr-20">
                <div fxLayout="row wrap" fxLayoutAlign="start center" class="pt-15 form-row">
                    <form class="example-form" [formGroup]="form">

                        <span fxFlex="20" fxFlex.md="25" fxFlex.sm="50" fxFlex.xs="100" class="form-group mb-sm-10">
                            <mat-form-field appearance="outline" class="no-error">
                                <mat-label>Investment Type *</mat-label>
                                <mat-select class="form-control" formControlName="investmentType">
                                    <div *ngFor="let a of dropDownDetails">
                                        <mat-option [value]="a" (click)="onSelectInvestmentType(a)">{{a}}</mat-option>
                                    </div>
                                </mat-select>
                            </mat-form-field>
                        </span>
                        <span fxFlex="20" fxFlex.md="25" fxFlex.sm="50" fxFlex.xs="100" class="form-group mb-sm-10">
                            <mat-form-field appearance="outline" class="no-error">
                                <mat-label>Percentage (%)</mat-label>
                                <input type="number" matInput class="form-control" formControlName="percent"
                                    (input)="onChangePercent(form.controls['percent'].value)">

                            </mat-form-field>
                        </span>
                        <span fxFlex="20" fxFlex.md="25" fxFlex.sm="50" fxFlex.xs="100" class="form-group mb-sm-10">
                            <mat-form-field appearance="outline" class="no-error">
                                <mat-label>Amount</mat-label>
                                <input type="number" matInput class="form-control" formControlName="amount"
                                    (input)="onChangeAmount(form.controls['amount'].value)">

                            </mat-form-field>
                        </span>
                        <span fxFlex fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxLayout="row"
                            fxLayoutAlign="end center" fxLayoutGap="10px" class="form-group pt-md-15 pt-sm-15">

                            <div matTooltip="If you have active shares in the bellow table then only this button is enabled"
                                matTooltipClass="custom-tooltip"
                                [matTooltipDisabled]="!isClosePositionsButtonDisabledOrEnabled">
                                <button mat-stroked-button class="custom-button-disabled" (click)="closeAllPositions()"
                                    [disabled]="isClosePositionsButtonDisabledOrEnabled">Close Positions</button>
                            </div>
                            <div matTooltip="In the bellow table is there any new symbol add or removed existing symbol then only this button is enabled"
                                matTooltipClass="custom-tooltip"
                                [matTooltipDisabled]="!isRebalanceButtonDisableOrEnable">
                                <button mat-stroked-button [disabled]="isRebalanceButtonDisableOrEnable"
                                    class="custom-button-disabled" (click)="reBalance()">Rebalance</button>
                            </div>
                        </span>
                    </form>

                </div>                


                <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-info"
                    *ngIf="(form.controls['amount'].value || selection.selected.length<=0 || closePositionsButtonClicked ) && form.controls['amount'].value <= cash_balance">
                    <img src="/assets/images/alert-info-icon.svg" />
                    <p class="no-margin" *ngIf="selection.selected.length<=0">*Please select the symbols first.</p>
                    <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Equal Distribution'"> {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}} will be equally invested into each of the selected {{selection.selected.length}} stocks.</p>
                    <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Investment Per stock'"> {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}}  amount will be invested into each of the {{selection.selected.length}} stocks.</p>
                    <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Scale Up'">An additional amount of {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}} will be invested into each of the selected {{selection.selected.length}} stocks.</p>
                    <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Scale Down'">The {{selection.selected.length}} selected stocks will be reduced by {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}}.</p>
                    <p class="no-margin" *ngIf="closePositionsButtonClicked">The selected stocks will be closed.</p> 
                </div>
                <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-warn"
                *ngIf="form.controls['percent'].value && form.controls['percent'].value > 100">
                <img src="/assets/images/alert-info-icon.svg" />
                <p class="no-margin"  > Exceeds 100 %</p>
            </div>
            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-warn"
                *ngIf="form.controls['amount'].value && form.controls['amount'].value > cash_balance">
                <img src="/assets/images/alert-info-icon.svg" />
                <p class="no-margin" > Exceeds the cash balance {{cash_balance | currency:'USD':'symbol':'1.2-2'}}</p>
            </div>
            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-info"
            >
            <img src="/assets/images/alert-info-icon.svg" />
            <p class="no-margin" >*Please select the symbols first.</p>
</div>
              
                <div *ngIf="isPositions"
                    class="trading-table height-auto table-scroll trade-c-table with-padding pt-15">
                    <table mat-table [dataSource]="dataSource" class="trade_multiheader_table">

                        <ng-container matColumnDef="select">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{'display': 'none'}">
                                <mat-checkbox (change)="$event ? toggleAllRows() : null" color="primary"
                                    [checked]="selection.hasValue() && isAllSelected()"
                                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                                    [aria-label]="checkboxLabel()">
                                </mat-checkbox>
                            </th>
                            <td mat-cell *matCellDef="let row">
                                <mat-checkbox (click)="singleSelect($event,row)" color="primary"
                                    (change)="$event ? selection.toggle(row) : null"
                                    [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                </mat-checkbox>
                            </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="selecthide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2">
                                <mat-checkbox (change)="$event ? toggleAllRows() : null" color="primary"
                                    [checked]="selection.hasValue() && isAllSelected()"
                                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                                    [aria-label]="checkboxLabel()">
                                </mat-checkbox>
                            </th>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="symbol">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{'display': 'none'}"> Symbol </th>
                            <td mat-cell *matCellDef="let element">
                              
                                <div class="indicator_parent">
                                    <a (click)="$event.stopPropagation()">{{element.symbol}}
                                    </a>
                                    <div class="indicators">
                                        <img *ngIf="element.reBalance == 0" style="color: green;"
                                            src="assets/images/new-added-badge.svg">
                                        <img *ngIf="element.reBalance == 2" style="color: red;"
                                            src="assets/images/removed-badge.svg">

                                    </div>
                                </div>
                            </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="symbolhide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2"> Symbol </th>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>


                        <ng-container matColumnDef="price">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{'display': 'none'}"
                                class="right-align-cell"> Price </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                <span *ngIf="getColor(element)" [@fadeInOut]>{{ element.price |
                                    currency:'USD':'symbol':'1.2-2' }}</span>
                                <span *ngIf="!getColor(element)">{{ element.price | currency:'USD':'symbol':'1.2-2'
                                    }}</span>
                            </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="pricehide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2" class="right-align-cell"> Price
                            </th>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="cost">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{'display': 'none'}"
                                class="right-align-cell"> Cost </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                <span>{{ element.cost | currency:'USD':'symbol':'1.2-2'
                                    }}</span>
                            </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="costhide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2" class="right-align-cell"> Cost
                            </th>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <ng-container matColumnDef="shares">
                            <th mat-header-cell *matHeaderCellDef
                                [ngStyle]="isDisplayColumn?{'display': 'center','text-align':'right'}:{'display': 'none'}">
                                Current </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                {{ element.shares | number: '0.0-0' }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef> Total </td>
                        </ng-container>
                        <ng-container *ngIf="isDisplayColumn" matColumnDef="new_shares">
                            <th mat-header-cell *matHeaderCellDef class="right-align-cell"> New </th>
                            <td mat-cell *matCellDef="let element" class="with-grey-bg right-align-cell"
                                [ngClass]="getChangeStyle(element.new_shares)">
                                {{   element.new_shares  }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>


                        <ng-container matColumnDef="shareshide">
                            <th mat-header-cell *matHeaderCellDef [attr.colspan]="isDisplayColumn?2:1"
                                [attr.rowspan]="isDisplayColumn?1:2" class="text-center"> Shares </th>
                        </ng-container>

                        <ng-container matColumnDef="invested">
                            <th mat-header-cell *matHeaderCellDef
                                [ngStyle]="isDisplayColumn?{'display': 'center','text-align':'right'}:{'display': 'none'}">
                                Current </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                {{ element.invested | currency:'USD':'symbol':'1.2-2' }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef class="right-align-cell"> {{
                                (invested | currency:'USD':'symbol':'1.2-2') }} </td>
                        </ng-container>
                        <ng-container *ngIf="isDisplayColumn" matColumnDef="new_invested">
                            <th mat-header-cell *matHeaderCellDef class="right-align-cell"> New </th>
                            <td mat-cell *matCellDef="let element" class="with-grey-bg right-align-cell"
                                [ngClass]="getChangeStyle(element.new_shares)">
                                {{ element.new_invested | currency:'USD':'symbol':'1.2-2' }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef class="right-align-cell"> {{
                                ( calculateTotal('new_invested') | currency:'USD':'symbol':'1.2-2') }} </td>
                        </ng-container>

                        <ng-container matColumnDef="investedhide">
                            <th mat-header-cell *matHeaderCellDef [attr.colspan]="isDisplayColumn?2:1"
                                [attr.rowspan]="isDisplayColumn?1:2" class="text-center"> Invested </th>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>




                        <tr mat-header-row
                            *matHeaderRowDef="['selecthide', 'symbolhide',  'pricehide','costhide','shareshide', 'investedhide',]">
                        </tr>
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns:displayedColumns" (click)="selection.toggle(row)">
                        </tr>
                    </table>
                </div>

                <div class="indicator_parent_define" *ngIf="isPositions && !isRebalanceButtonDisableOrEnable">
                    <div class="indicators">
                        <img src="assets/images/new-added-badge.svg">Symbol was Newly added in the Basket
                    </div>
                    <div class="indicators">
                        <img src="assets/images/removed-badge.svg">Symbol Was Removed by the Basket Owner
                    </div>

                </div>
                <div *ngIf="isPositions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px"
                    class="pt-15 pb-15">
                    <button mat-stroked-button class="secondary-btn"  (click)="cancel()">Cancel</button>
                    <button mat-flat-button class="custom-button-disabled" [disabled]="!this.isDisplayColumn " (click)="confirmTrade()">Submit</button>
                </div>
            </div>
        </div>
        <div *ngIf="!(linkedAccount && linkedAccount.broker_account_id)">
            <br>
            <h3>You must <a style="color: blue;" (click)="navigateLinkAccount()"><u>link an account</u></a> in order to
                execute trades</h3>
        </div>
        <div *ngIf="!brokerageIsDisconnected">
            <br>
            <h3>Your brokerage account is disconnected so please <a style="color: blue;" (click)="navigateLinkBrokerage()"><u>link the brokerage </u></a> in order to
                execute trades  </h3>
        </div>
    </div>
</div> -->



<!-- <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="breadcrumb pt-10 pb-10 pl-20 pr-20">
    <a routerLink="/" fxLayout="column" fxLayoutAlign="center center">
        <img src="/assets/images/home-icon.svg" />
    </a>
    <span>/</span>
    <a routerLink="/my-basket" class="bold">Baskets</a>
    <span>/</span>
    <a class="bold">Trade</a>
</div> -->
<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px"
class="breadcrumb with-bg with-border pt-10 pb-10 pl-20 pr-20">
<a routerLink="/" fxLayout="column" fxLayoutAlign="center center">
    <img src="/assets/images/home-icon.svg" />
</a>
<span>/</span>
<a routerLink="/baskets" class="bold">Baskets</a>
<span>/</span>
<a class="bold">{{basket.name}} / Trade</a>
</div>
<div class="main_wrapper trade_module bg-body text-dark">
    <h1 class="mat-h1 font-700 ">Account Basket Summary</h1>
    <div class="primary-sub-section-white">
        <div fxLayout="row wrap" fxLayoutAlign="start center" class="form-row">
            <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row" fxLayoutAlign="start center"
                class="form-group pt-5 pb-5">
                <div fxLayout="column">
                    <span fxFlex="initial" class="trade-icon-round" *ngIf="!(linkedAccount && linkedAccount.broker_account_id)">
                        <mat-icon class="icon_symbol text-primary" fontIcon="shopping_basket"></mat-icon>
                    </span>
                    <div fxLayout="column" *ngIf="!(linkedAccount && linkedAccount.broker_account_id)">
                        <p class="no-margin">Basket</p>
                        <h3 class="mat-h3 no-margin font-600">{{basket.name}}</h3>
                    </div>
                    <p class="sub-text" *ngIf="(linkedAccount && linkedAccount.broker_account_id)">{{linkedAccount.broker_name}}</p>
                    <h3 class="mat-h1 no-margin font-600" *ngIf="(linkedAccount && linkedAccount.broker_account_id)">{{linkedAccount.broker_account_id}}</h3>
                </div>
            </div>
            <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row" fxLayoutAlign="start center"
                class="form-group pt-5 pb-5">
                <div fxLayout="column">
                    <p class="sub-text">Buying Power</p>
                    <h3 class="mat-h1 no-margin font-600">{{account_balance | currency:'USD':'symbol':'1.2-2' }}</h3>
                </div>
            </div>
            <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row" fxLayoutAlign="start center"
                class="form-group pt-5 pb-5">
                <div fxLayout="column">
                    <p class="sub-text">Current Cash Balance</p>
                    <h3 class="mat-h1 no-margin font-600">{{cash_balance | currency:'USD':'symbol':'1.2-2' }}</h3>
                </div>
            </div>
            <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row" fxLayoutAlign="start center"
                class="form-group pt-5 pb-5">
                <div fxLayout="column">
                    <p class="sub-text">Invested</p>
                    <h3 class="mat-h1 no-margin font-600">{{invested | currency:'USD':'symbol':'1.2-2' }}</h3>
                </div>
            </div>
            <div fxFlex="20" fxFlex.md="33.3" fxFlex.sm="50" fxFlex.xs="100" fxLayout="row" fxLayoutAlign="start center"
                class="form-group pt-5 pb-5">
                <div fxLayout="column">
                    <p class="sub-text">Market Value</p>
                    <h3 class="mat-h1 no-margin font-600">{{market_value | currency:'USD':'symbol':'1.2-2' }}</h3>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-20">

        <div *ngIf="!(linkedAccount && linkedAccount.broker_account_id)">
            <br>
            <h3>You must <a style="color: blue;" (click)="navigateLinkAccount()"><u>link an account</u></a> in order to
                execute trades</h3>
        </div>
        <div *ngIf="!brokerageIsDisconnected">
            <br>
            <h3>Your brokerage account is disconnected so please <a style="color: blue;" (click)="navigateLinkBrokerage()"><u>link the brokerage </u></a> in order to
                execute trades  </h3>
        </div>
        <div class="content-section" fxFlex fxLayout="row" fxLayoutGap="10px" *ngIf="linkedAccount && linkedAccount.broker_account_id && brokerageIsDisconnected">
            <div class="table-section" fxFlex="75">
                <div class="table-top">
                    <div fxFlex>
                        <div fxFlex="50" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px">
                            <img src="/assets/images/alert-info-icon.svg" class="grayscale" />
                            <p class="no-margin" *ngIf="selection.selected.length == 0">
                                Please select the symbols first.
                            </p>
                            <p class="no-margin" *ngIf="selection.selected.length != 0">
                                Please select the investment type and enter the percent or amount then bellow selected symbols will effect.
                            </p>
                        </div>
                        <div fxLayout="row" fxFlex="50" fxLayoutAlign="end center" fxLayoutGap="10px">
                            <span fxFlex fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxLayout="row"
                                fxLayoutAlign="end center" fxLayoutGap="10px" class="form-group pt-md-15 pt-sm-15">

                                <div matTooltip="If you have active shares in the bellow table then only this button is enabled"
                                matTooltipClass="custom-tooltip"
                                [matTooltipDisabled]="!isClosePositionsButtonDisabledOrEnabled">
                                <button mat-stroked-button class="custom-button-disabled" (click)="closeAllPositions()"
                                    [disabled]="isClosePositionsButtonDisabledOrEnabled">Close Positions</button>
                            </div>
                            <div matTooltip="In the bellow table is there any new symbol add or removed existing symbol then only this button is enabled"
                                matTooltipClass="custom-tooltip"
                                [matTooltipDisabled]="!isRebalanceButtonDisableOrEnable">
                                <button mat-stroked-button [disabled]="isRebalanceButtonDisableOrEnable"
                                    class="custom-button-disabled" (click)="reBalance()">Rebalance</button>
                            </div>
                            
                                <!-- <button mat-stroked-button class="primary-btn">Close All Position</button>
                                <div matTooltip="In the bellow table is there any new symbol add or removed existing symbol then only this button is enabled"
                                matTooltipClass="custom-tooltip"
                                [matTooltipDisabled]="!isRebalanceButtonDisableOrEnable">
                                <button mat-stroked-button class="secondary-btn">Rebalance</button>
                                </div> -->
                            </span>
                        </div>
                    </div>

                </div>

                <div class="trading-table height-auto table-scroll trade-c-table with-padding pt-15" >
                    <table mat-table [dataSource]="dataSource" class="trade_multiheader_table">
                        <ng-container matColumnDef="select">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{ display: 'none' }">
                                <mat-checkbox (change)="$event ? toggleAllRows() : null" color="primary"
                                    [checked]="selection.hasValue() && isAllSelected()"
                                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                                    [aria-label]="checkboxLabel()">
                                </mat-checkbox>
                            </th>
                            <td mat-cell *matCellDef="let row" class="head">
                                <mat-checkbox (click)="$event.stopPropagation()" color="primary"
                                    (change)="$event ? selection.toggle(row) : null"
                                    [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                </mat-checkbox>
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="selecthide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2" class="head">
                                <mat-checkbox (change)="$event ? toggleAllRows() : null" color="primary"
                                    [checked]="selection.hasValue() && isAllSelected()"
                                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                                    [aria-label]="checkboxLabel()">
                                </mat-checkbox>
                            </th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="symbol">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{ display: 'none' }">
                                Symbol
                            </th>
                            <td mat-cell *matCellDef="let element">
                                <div class="indicator_parent">
                                    <a (click)="$event.stopPropagation()">{{ element.symbol }}</a>
                                    <div class="indicators">
                                        <img *ngIf="element.reBalance == 0" style="color: green;"
                                            src="assets/images/new-added-badge.svg">
                                        <img *ngIf="element.reBalance == 2" style="color: red;"
                                            src="assets/images/removed-badge.svg">
                                    </div>
                                </div>
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="symbolhide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2">Symbol</th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="price">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{ display: 'none' }"
                                class="right-align-cell ">
                                Price
                            </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                {{ element.price | currency : "USD" : "symbol" : "1.2-2" }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="pricehide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2" class="right-align-cell">Price</th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>
                        <ng-container matColumnDef="cost">
                            <th mat-header-cell *matHeaderCellDef [ngStyle]="{ display: 'none' }"
                                class="right-align-cell ">
                                Cost
                            </th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                {{ element.cost | currency : "USD" : "symbol" : "1.2-2" }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="costhide">
                            <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2" class="right-align-cell">Cost</th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="shares">
                            <th mat-header-cell *matHeaderCellDef
                                [ngStyle]="isDisplayColumn?{'display': 'center','text-align':'right'}:{'display': 'none'}">
                                Current</th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell ">
                                {{ element.shares }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container *ngIf="isDisplayColumn" matColumnDef="new_shares">
                            <th mat-header-cell *matHeaderCellDef class="!text-right">New</th>
                            <td mat-cell *matCellDef="let element" class="with-blue-bg  right-align-cell">
                                {{ element.new_shares }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef>Total</td>
                        </ng-container>

                        <ng-container matColumnDef="shareshide">
                            <th mat-header-cell *matHeaderCellDef [attr.colspan]="isDisplayColumn?2:1"
                                class="text-center">
                                Shares
                            </th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="invested">
                            <th mat-header-cell *matHeaderCellDef
                                [ngStyle]="isDisplayColumn?{'display': 'center','text-align':'right'}:{'display': 'none'}">
                                Current</th>
                            <td mat-cell *matCellDef="let element" class="right-align-cell">
                                {{
                                element.invested | currency : "USD" : "symbol" : "1.2-2"
                                }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef class="right-align-cell">
                                {{( calculateTotal('invested') | currency:'USD':'symbol':'1.2-2') }}                            
                            </td>
                        </ng-container>

                        <ng-container *ngIf="isDisplayColumn" matColumnDef="new_invested">
                            <th mat-header-cell *matHeaderCellDef class="!text-right">New</th>
                            <td mat-cell *matCellDef="let element" class=" with-blue-bg  right-align-cell">
                                {{ element.new_invested | currency : "USD" : "symbol" : "1.2-2" }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef class="right-align-cell">
                                {{( calculateTotal('new_invested') | currency:'USD':'symbol':'1.2-2') }}                            </td>
                        </ng-container>

                        <ng-container matColumnDef="investedhide">
                            <th mat-header-cell *matHeaderCellDef [attr.colspan]="isDisplayColumn?2:1"
                                class="text-center">
                                Invested
                            </th>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>


                        <tr mat-header-row *matHeaderRowDef="[
                    'selecthide',
                    'symbolhide',
                    'pricehide',
                    'costhide',
                    'shareshide',
                    'investedhide'
                ]" class="tbl"></tr>
                        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="tbl"></tr>
                        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns" (click)="selection.toggle(row)">
                        </tr>
                    </table>
                </div>
                <!-- <mat-paginator [pageSizeOptions]="[10, 50, 100]" showFirstLastButtons
                    aria-label="Select page of periodic elements">
                </mat-paginator> -->
            </div>
            <div class="calculate-section sideSection" fxFlex="25" fxLayout="column"  fxLayoutAlign="space-between">
                <div class="top-section">
                    <h3 class="mat-h2 no-margin font-600">Trade</h3><br>
                    <form class="example-form" [formGroup]="form">

                    <div fxLayout="column wrap" fxLayoutAlign="start center" fxLayoutGap="10px"
                        class=" form-row   sideSectionOne " >
                        <span class="form-group customInput">
                            <mat-form-field appearance="outline" class="no-error bg-white">
                                <mat-label>Investment Type *</mat-label>
                                <mat-select class="form-control" formControlName="investmentType">
                                    <div *ngFor="let a of dropDownDetails">
                                        <mat-option [value]="a" (click)="onSelectInvestmentType(a)">{{a}}</mat-option>
                                    </div>
                                </mat-select>
                            
                            </mat-form-field>
                        </span>
                        <span class="form-group customInput">
                            <mat-form-field appearance="outline" class="no-error bg-white">
                                <mat-label>Percentage (%)</mat-label>
                                <input type="number" matInput class="form-control" formControlName="percent"
                                (input)="onChangePercent(form.controls['percent'].value)">
                            </mat-form-field>
                        </span>
                        <span class="form-group customInput">
                            <mat-form-field appearance="outline" class="no-error bg-white">
                                <mat-label>Amount</mat-label>
                                <input type="number" matInput class="form-control" formControlName="amount"
                                (input)="onChangeAmount(form.controls['amount'].value)">
                            </mat-form-field>
                        </span>
                        <div class="form-group" style="padding-top: 1rem;">
                            <div fxFlex class="customParagraph" fxLayoutAlign="start start" fxLayout="row"
                                fxLayoutGap="8px" *ngIf="(form.controls['amount'].value || selection.selected.length<=0 || closePositionsButtonClicked ) && form.controls['amount'].value <= cash_balance">
                                <img fxFlex="6" src="/assets/images/alert-info-icon.svg" />
                                <p class="no-margin" *ngIf="selection.selected.length<=0">*Please select the symbols first.</p>
                                <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Equal Distribution'"> {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}} will be equally invested into each of the selected {{selection.selected.length}} stocks.</p>
                                <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Investment Per stock'"> {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}}  amount will be invested into each of the {{selection.selected.length}} stocks.</p>
                                <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Scale Up'">An additional amount of {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}} will be invested into each of the selected {{selection.selected.length}} stocks.</p>
                                <p class="no-margin" *ngIf="this.form.controls['investmentType'].value === 'Scale Down'">The {{selection.selected.length}} selected stocks will be reduced by {{ form.controls['amount'].value | currency:'USD':'symbol':'1.2-2'}}.</p>
                                <p class="no-margin" *ngIf="closePositionsButtonClicked">The selected stocks will be closed.</p> 
            
                            </div>
                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-warn"
                            *ngIf="form.controls['percent'].value && form.controls['percent'].value > 100">
                            <img src="/assets/images/alert-info-icon.svg" />
                            <p class="no-margin"  > Exceeds 100 %</p>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px" class="trade-warn"
                            *ngIf="form.controls['amount'].value && form.controls['amount'].value > cash_balance">
                            <img src="/assets/images/alert-info-icon.svg" />
                            <p class="no-margin" > Exceeds the cash balance {{cash_balance | currency:'USD':'symbol':'1.2-2'}}</p>
                        </div>

                        </div>
                        
                        <!-- <span class="form-group w-full" fxLayoutAlign="end end">
                            <button mat-flat-button class="green-button" (click)="calculateDialog()">
                                Calculate
                            </button>
                        </span> -->

                    </div>
                    </form>
                    <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px" style="padding-top: 15px; padding-bottom: 15px;">
                        <button mat-stroked-button class="secondary-btn"  (click)="cancel()">Cancel</button>
                        <button mat-flat-button class=" custom-button-disabled" [disabled]="!this.isDisplayColumn " (click)="confirmTrade()">Submit</button>
                    
                    </div>
                </div>

                <div class="indicator_parent_define w-full" *ngIf="!isRebalanceButtonDisableOrEnable">
                    <div class="indicators color_light">
                        <img src="assets/images/new-added-badge.svg" />Symbol was Newly added in
                        the Basket
                    </div>
                    <div class="indicators color_light">
                        <img src="assets/images/removed-badge.svg" />Symbol Was Removed by the
                        Basket Owner
                    </div>
                </div>
            </div>

        </div>

    </div>


</div>


